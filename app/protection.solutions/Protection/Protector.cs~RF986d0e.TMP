using protection.solutions.Protection;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading;
using System.Threading.Tasks;
using Console = Colorful.Console;

namespace protection.solutions
{
    class Protector
    {
        public static List<string> blockedFiles = new List<string>();
        public static void prefix(Color color)
        {
            Console.ForegroundColor = Color.White;
            Console.Write("{");
            Console.ForegroundColor = color;
            Console.Write("$");
            Console.ForegroundColor = Color.White;
            Console.Write("}");
        }
        public static void check_hash(string sha256sum, string path)
        {
            // high danger level viruses
            if (sha256sum == "7QHr+8nrW76lRa9NAb9fEHFmGEBIBDnG5bq+jggOQao=")
            {
                prefix(Color.Red);
                Console.Write(" WannaCry ransomware Found! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" WannaCry ransomware Deleted \n");
                windows_notification.show("Wannacry ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "JrRpmnue6xbnYwXYQ9SrBelNQ/MgFDaSfhOz66+pBzk=")
            {
                prefix(Color.Red);
                Console.Write(" Petya ransomware Found! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" Petya ransomware Deleted \n");
                windows_notification.show("Petya ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "9dACv+gLSDhqbJnEFSiTG39d9zbNNAlEY8P4Xd4BgL8=")
            {
                prefix(Color.Red);
                Console.Write(" InfinityCrypt ransomware Found! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" InfinityCrypt Deleted \n");
                windows_notification.show("InfinityCrypt ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "nD+N+AGTwIWRLJlQxYBRrnfDIZdXhMwGnOrNT1fVhh0=")
            {
                prefix(Color.Red);
                Console.Write(" PowerPoint ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" PowerPoint ransomware Deleted \n");
                windows_notification.show("PowePoint ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "fTc8y5bR27GFbvMa+ofCESoMF5WnlqsByxVHACiK/sU=")
            {
                prefix(Color.Red);
                Console.Write(" 7ev3n ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" 7ev3n ransomware Deleted \n");
                windows_notification.show("7ev3n ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "stz9+eewnyqlAEZoNw53mCljrOgg5yhbLiZKKURB2iM=")
            {
                prefix(Color.Red);
                Console.Write(" Birele ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" Birele ransomware Deleted \n");
                windows_notification.show("Birele ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "s+Hp2X10xBbCow3RGFh4mvVVTPLeYvV3wTlEoZYjd30=")
            {
                prefix(Color.Red);
                Console.Write(" Cerber5 ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" Cerber5 ransomware Deleted \n");
                windows_notification.show("Cerber5 ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "YwMlysCaw/q5CPkD47ANDa3V/aoIde2Elvy7l6VY0No=")
            {
                prefix(Color.Red);
                Console.Write(" Badrabbit ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" Badrabbit ransomware Deleted \n");
                windows_notification.show("Badrabbit ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "T1v/ZBYARNmnaasnf/hbqVTiouGCxtpNBnJ5DPHUgwk=")
            {
                prefix(Color.Red);
                Console.Write(" Derialock ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" Derialock ransomware Deleted \n");
                windows_notification.show("DeriaLock ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "9CNKUB7c0w07wVyYNpLJRQODtzvdMQBZQFxeOkPMcws=")
            {
                prefix(Color.Red);
                Console.Write(" Fantom ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" Fantom ransomware Deleted \n");
                windows_notification.show("Fantom ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "aLDhky87RDmGW+hIwtWS1RdNvbqrj2YQSg5bKMko7gw=")
            {
                prefix(Color.Red);
                Console.Write(" Winlocker ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" Winlocker ransomware Deleted \n");
                windows_notification.show("WinLocker ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "OrODPjHkCDAmQhxkEwQ2ms/TG5V7eK+B88bvSWjvDhU=")
            {
                prefix(Color.Red);
                Console.Write(" Xyeta ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" Xyeta ransomware Deleted \n");
                windows_notification.show("Xyeta ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "558WTMx1pdXAMrTFqW1q12BPr/sor+d7wpuRc/o1Q+Q=")
            {
                prefix(Color.Red);
                Console.Write(" Krotten ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" Krotten ransomware Deleted \n");
                windows_notification.show("Krotten ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "KqsT1JtgAB3jqkf7j3JRqXP6p/PFOjhAzfX9CybpoJ8=")
            {
                prefix(Color.Red);
                Console.Write(" NoMOreRansom ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" NoMOreRansom ransomware Deleted \n");
                windows_notification.show("NoMOreRansom ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "GJjyyuHjgkyw9/1TaBcaM6uheeY1AeSAtNqeoF6/BCM=")
            {
                prefix(Color.Red);
                Console.Write(" PolyRansom ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" PolyRansom ransomware Deleted \n");
                windows_notification.show("PolyRansom ransomware deleted", "Click here for details!");
            }
            else if (sha256sum == "QYOV79JpvGU04CySyyxWhjGtpuVLxVreTkpZhmBf94Y=")
            {
                prefix(Color.Red);
                Console.Write(" ViraLock ransomware detected! \n");
                Deleter.Delete(path);
                prefix(Color.Green);
                Console.Write(" ViraLock ransomware Deleted \n");
                windows_notification.show("Viralock ransomware deleted", "Click here for details!");
            }
            // medium danger tier viruses
            else if (sha256sum == "o9VxWoHy++tfdsiMnCHu7ocUKQlxZHL5Ef9pUMeQwk0=")
            {
                prefix(Color.Orange);
                Console.Write(" Memz detected! \n");
                File.Delete($"{path}");
                prefix(Color.Green);
                Console.Write(" Memz deleted! \n");
                windows_notification.show("Memz deleted", "Click here for details!");
            }
            // low danger tier viruses
            else if (sha256sum == "Ktyir+pgvcZ+4W0aoEwJuoerSbC+YWB5wIu1omET9bg=")
            {
                prefix(Color.Yellow);
                Console.Write(" m3m3war3 detected! \n");
                Deleter.Delete(path);
                Protector.prefix(Color.Green);
                Console.Write(" m3m3war3 deleted! \n");
                windows_notification.show("m3m3war3 deleted", "Click here for details!");
            }
            else if (sha256sum == "zLlQK/i6W+z4t1jKBKViXDC3ni0Q0md8xDrkJT4SiOw=")
            {
                prefix(Color.Yellow);
                Console.Write(" Chilledwindows detected! \n");
                Deleter.Delete(path);
                Protector.prefix(Color.Green);
                Console.Write(" Chilledwindows deleted! \n");
                windows_notification.show("Chilledwindows deleted", "Click here for details!");
            }
            else
            {
                Program.is_used_by_another_process = false;
            }
        }
        public static void check_extension(string extension, string path)
        {
            if (extension == ".wcry")
            {
                // blocking file fucking
                for (int i = 0; i < blockedFiles.Count; i++)
                {
                    if (blockedFiles[i] == path)
                    {

                    }
                    else
                    {
                        if (i == blockedFiles.Count)
                        {
                            blockedFiles.Add($"{path}");
                            File.Encrypt($"Files\\{Path.GetFileName($"{path}")}");
                        }
                    }
                }
            }
            else
            {
                File.Delete($"{path}");
            }
        }
    }
}
